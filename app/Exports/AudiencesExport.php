<?php namespace App\Exports; use App\Models\Audience; use Maatwebsite\Excel\Concerns\FromCollection; use Maatwebsite\Excel\Concerns\WithHeadings; class AudiencesExport implements FromCollection, WithHeadings { public function collection() { return Audience::with(['dossier','user']) ->get() ->map(function($audience){ return [ 'ID' => $audience->id, 'Date' => $audience->date_audience, 'Salle' => $audience->salle, 'Dossier' => $audience->dossier->numero_dossier ?? '', 'Juge' => $audience->user->name ?? '', ]; }); } public function headings(): array { return ['ID', 'Date', 'Salle', 'Dossier', 'Juge']; } }